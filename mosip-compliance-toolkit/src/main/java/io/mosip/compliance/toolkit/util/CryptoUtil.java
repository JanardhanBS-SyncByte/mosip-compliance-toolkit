package io.mosip.compliance.toolkit.util;

import java.nio.ByteBuffer;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.security.NoSuchProviderException;
import java.security.Security;
import java.util.Arrays;
import java.util.Base64;

import org.apache.commons.codec.DecoderException;
import org.apache.commons.codec.binary.Hex;
import org.bouncycastle.jce.provider.BouncyCastleProvider;

public final class CryptoUtil {

	public static void main(String[] args) {
		String transactionId = "SBI1018-533";
		String timestamp = "2022-12-08T11:13:46Z";
		byte[] xorResult = getXOR(timestamp, transactionId);
		byte[] aadBytes = getLastBytes(xorResult, 16);
		byte[] ivBytes = getLastBytes(xorResult, 12);
		
		String xorTransactionIdWithTimestamp = StringUtil.toUtf8String(xorResult);
		
		System.out.println("transactionId==" + transactionId);
		System.out.println("timestamp==" + timestamp);
		System.out.println("xorTransactionIdWithTimestampApp==" + xorTransactionIdWithTimestamp.length());
		String aad = StringUtil.base64UrlEncode(aadBytes);
		String iv = StringUtil.base64UrlEncode(ivBytes);

		System.out.println("aad==" + aad);
		System.out.println("iv==" + iv);

		String certThumbprint = "D0B0E78C5E8C4AF36B445159D95D6F6A02F344C93164669E833B71E59BEC6E66";
		String encryptedSessionkey = "MgfQ-kTuVPZ9PWsUMPKbJZ1vIDZxqRn_xSwth_PTMc7UlhWISMlkK01jjg8M3qwzdIS7aecS8C3JzMnDp4EsJnFpn4ZcLDbaIGQCIPVt-hkpBZYDWLpasJ1mjrpihRHXuipECF-aArVR0uNu0wogZHSfgIP9tQ5pHt3xFg2avH0LEPTeWO4gD5v-EHkb_nBdy6tSeurtbYnpzRgaHZV5Dxuii3gBVRBJTMAzAwC6oNMwS_S878DRSOuogFDzcJvVXoK2YBH50P9w_S-LHc6dbQP5Qa-XjTEPUMtZsv6OD3lCWv_WzJTCXaSQqlV71tx3Y9-Cr56Y8tuQ3DtBU3lHSA";
		String KEY_SPLITTER = "#KEY_SPLITTER#";
		String encryptedData = "DOlAR7_Y2vstYj7M-7Hr4LLQfDParl67wgkbtTxkEsPP-ynXMyY1ELD_vYfszaSgdFHEinhznjmFr_1jeJXfQySVdZOz7O0JlEqFE9flGmNtTVrx80e1rewpeIqttdpSgjxls_eJKlhsI_fywy7AzU0tbUx3dizElYalyPqSGR56vdNwXAKkghK_ynutE0VSH7oFbG5tsfgNvlmwTlaJKFn2asUFXYxMowMEwX1SwM-l3FgTNKMPq2VgA82ewufLJ_Es8eR8i6pohI3J9MHY8ySYksKGh85gqyzD8AxIfoqukzyFHxcSqUrmdlV2nCpAGmvuln3-p2QHjCZ_0ur-qymRidUwl3tQNwsEa19R2ZBe2tkQPM5Pb3tN7fVWfFk5cLztn3kiH--1kh_kl7Byx5_P3zjwNi4wSYohrAUcj4vtqxsIu5Gjz91V0ddoVg93p9JQUnxOY1LF7TPMQsy8d0VgeNJBWfYSp_5hFczSRXCiXbEo3H53dL5W2gQ4d0uWN8XDkykqitZY-gEMWlrYc-vRMbb8InbMXFdeTvmHLG6ETgL03uYdoXCprUiOGWxSsXKVqODtviKFsnHwdda6IhN5DFb-eRHw-BrrC2Iu5nPGQB6DGUm9WHjLPHMg0e-yqami-pTvhzQtE-Er9l5047LD1ES4wKEi46_ruvRp7brSpjvys23if64qXFMNhDVp3sRkW3ry3z83AwyKWpu9X0xJ9CUwPvoE5DdYVehupXvX6vk5kHn3v5piuY_sUT4iZ6nizk_pjX30CatVVwfxdJ1L8qX4nm7SnGFJPghVasU7cu_9ukzExiMJScsWIJwSeAYv1yq2in3jqheNyPt03OhyRDsKG406lfc2NQonjj-GY01WKXumJzKAnJDlMVj_vHafWvgvdz9kO3EY9Y6wux8fs3NbPF_aMSPELaEDD5xmYlcOKyTg-Q9OOdsrL9Ggdg_gBpuTixPiqOlv33CY_x2txJkTRvAZAQK4EllhO6R1Vs01b6ZelB39oQgRX10a1lSftMi6GGsxx0iQiWpy-hFCrN_qiTc7XeroiYczjseeXg3VUcW_7o0OMOTavvN1s64oES4ferAmqU9poGPNhdFWvFAgZGq6Ug-KlRTQtF8cvTljW3mrP-VGZiHAEZu47wJSRTkN8N4r2c-OEcZ_yAGLMPv15J-LONdzHJF719iicCGzCBG1GQoHpMBaYyv9IoGFFfP6MmD-cE53OoHN33oW2fjDnymmEcHLMcrhMRSFobV42vCEJrR1pAf2phHogjfuvzFJns5RouxwdBlX6Av8CZhDIPOdPu5-AjOqWHPbpgPGQJHwSh-nOqqtX0cpFtjMStAOqJMJzr1ZcZg3ZPOBk8e4F82_LgcAB38BWyk4mCujNZZ-09l_oPtrACfyf9CNPzPWEfQjZ2xZ-4MGIEvLIz87SHX2djnFF2-9SkBPCdpOorOCT0pmfeJ9FmqLZxQYN9hCC2Jf0VD-293gSQ_k5uOEZt92INBqctgRbWk0zvH3uFfytahi7xDOcF6F03Yh1tDYa-Zmyh6I6IQVtNPDYA5iQPSkrQreK5ew-EeCOZURVwUCUE3O5yqWVhZZw9MmRV6W-jOdwczFYpnUXHX1VLCb2bGacbm_tFazxMpCR1Q3KSymqaDW4ujzmEybFkO8SeLks15Qa0M7Sh3D625sCCdDcf7cmpb-NtdbAyxgT9aTH0cYmzguVOXl27yNpFtZqM0HZ-3PnICq5GqphBvqVMyui79wo3dCT8zJH0AzzTFPWlwKr80-wU34fNtlYUXUTtSVdDtAi_bWCjvJaYgtuRqZp5LUXjotvazVVMv81tX3OJ9iZRr-XiQxQeCYeJt9MvQWaDaNrVE2eFYGyXn5ODvk443Jn9-7tIVAbRdOivzQtNnqXHGs_0Ssqri2u4kjnd3wiZg_LUc2ll_bNln1t2sHoK1yPVki55oN7ibnKN4-iTBeVdlBp6YuoMXbpp8vrdt2BqU_53Lhnwp9B3acjlQBeZtpQAoo2nETfQtIQEDACHLH-cl6LCFVvQUg8OHe2v-SSDFHa0KtLfaDYOzEgT4NHoQU4pPPObdzYG1ECbZs7tZpr8fEFj5HRIF5utStZZV_87CrnePA1JdjQ6exkrZdj_39VvxZEJpjZBep4brvL0VEKx2ZWllYspGG-Fk0hdIZmVBdyh3PRusx0GbfUIZxgwKLXyonIPPjRqGsUYYgKjmliwgTFk61u2q6g1MfebdfvKt176Zzjny47JdLuaRonHKZGheRN6B7uFINdPCxUPLw6ljixIqI7hGO8BFuFq0wRCi-EnSIOCBIdLp4mW-0QK-gvKEd0oc3Lx_EkVQVPKtq-U2qnIwSyaEFqVr9-jU141ODlkEyckYt-HpA3wVfWe-iyVdRYRp_OqJ3QAhBJ-V33ZFHeRLL-GujJT0cyInLx1kN5JRcWvS-jT3vr73NiwNxjkPoAqgJ4cahdmedQyfw0CtisNO3lwj5ki2VQWvbqw59032x8njPkbr3gWaQJvFFKBiqyYTXAtGlSF1KiGzujy9UPnEb922USMUvSS4kcay7r-Ah9PLYm7-Yxt2Dgxq_a81f3ZHYRpC5wh4Ppu_UmKYZQx43J3NTdwN_5nbCXaXz-WKncONcnhr5PaeXuMw9Bb-xNtV5Li8R0ZbA0dy0AJUNcAp_chYn8xQ3nNKelIgvFfjuR32kTFDIodrBg-UJ4JE2fcF7NHsL3LyEUhUSIf3EyKR-keDxMh40M4tDbE944YOUZHBUpK5C5f6SjEK4ITC95jaHIL02MNfwE6r5sXJomb5jW5yATEOErYaa9ZfeaJKjYyg6m5CsTECz10Ti5tGOXfSf-_mHuLrAvErwiEsqTI9tNdcnJKHsXSMrF4STr3IL9h25FvLgai33itEJa_VatZ0Fma8C9q-KJXk5ey-oSZVv5IKO71VoQ5Fs8SwllK5CtQQA5B7Z9eVtd1dHsFrc5sRyc_vP0rY5o6IaTn0MD5U-hMNxvY0w-_F9OuhLqtzj0fsJIGmkHn5y276G1esEWBcAw_hm-U-vY3b1p-ugJXyOOQzkJFG9dSk_nZpBDxzk9UhNxj0Dqn--o9yORvcMDRUb1xLPhZLLDQj_m-MZFeZd_74a-WD2qWaQoamJ7U4M-ZhG7Mkqvg3I825BXmMj-5NBnjt9icRNY0dRUzAcQ9rk0xhnw7A7M15UHITOHWgVDmh8-aItlx_zmDWE86_H2XdQqisGgm0VQZFXVb-P6D7UUTEFc_2vNQIH6vCQyuvEwywUfmLpk7M23xfPRlYQikZv_IgFBW-ifUj1AjrmddhT8GFy6yv8Su8N-QAeshgm9_1QTls6DlQywl6bjvSybNdkIOgXSJth3ktcuQ9C4Ah45tTBEwrwYRW3IaIXpIU2mG7g-QOeAW1jxykIVGbqY2mEiel9nMwMifCjE2MrnZaMF7rnWG_OWCTvXgtSrpun6iUqa329_qNksG9yu1wktpvL3T3f1CjIibFD7rQMsglLMluUr28wR8Ra3C8As5abe2chsVy8ObMBhcydZufMS1XsWYJiBmvRtsuJ5nHZrZTJk2POWSu5VThEASXOZCxKFkzkWqzz7qb8LBNE0PyMc50feg_42VYpYuL947r5QBfa3sj2QxW3WLwhmfsRoizaLOb0v-gXpA5EDA7YqAmALHNtaIn5qaDse1guke--g6qom-dOsdt8ebwhN4AzBr4alyoow0cX24vrAcZcmLgWNUsE6ELZ3HnwN6hbKv56p0LrkuTPjEkvwCRrzECnu5dEG0ymwZbYXAvqdsjf9s2d3VJgOrg6cUKLaH7iC9q8HaH6G-2NCZ03dGmhQAadXtpMjrIqnI1ttIUBaQsA0PRigG-KOyUEeCLxBKNVnasUbh-lXezdcg8d1nWQ6rIEnWvyrZTKr5xl97G6LAdfoIGAf_pMZcsi1v256FirZrByrAvEinUVGCjMMF0W0J31jACw--Iwo20r4RJjrZVAUGFFmOM3k7FrZf7ddRQg3DAtYtAX5vB73KSlURjqNeAzx6b9sbe5YNHQybu8tjGfTadHg_BmKHVFIdMj4Fr-EDsp2La9hLTCNP20GuYtUW7xc339A5h2jCCTcVhuF0FGiSG_EoYvr5bTkhKgXFYGdjdEmOVWmCa-oNFdj_rWPWJzAOo4nzqQywCXzJ5Tf2jEIOfqoIXy0wjgy8dY5W8oRcc0xLw0dil3aj8ZSZqKXBWvdhQY7Am5VNDsZVUE8wWMXzrF87nEXdJJkk2ck7u-CTTcHH-U4WXV5L6VnKrKRwGhL30GE7eQwhWML-MFbse1pbbdRbjCWpasnKzQjT6X_4qEtnUmCKEVwAhn59VES_DSABe7OEei8zs7WhVTbAshln4cOn1TJ2LXsFCc3rRv2-Tn70rUR13Y_7rmJOYuVMWF9fbTw2HqB6-3RZuZfOnRZoBIUUMHC0kXMVHZ4VehsTE-__G-_kVWOLwicrJ81ataj57ju4yFQZKFmpd2NqE9PZGuf_vbkDRzLTfQmtKgP5N8mCQhYmm2utUtsSVCxKM-yjOCAEiyN5fncQgnBCG-zMVbtFGAhD5_gCp39sgLqY6XVHxHmWIog9QVg4yz5_cGqaSLGja6TZS9QMTpNElXMAAEb6Eu9O9LFA694pih2wWSjkoFQXP54xZC_WMG_PhpbhueVCzZdQ6oK1fGqQyBljnC8sQHmcA4TinALpTAOjYCVt8GITaKy8766JJvG_wNBck06KobFeXkD2nu_bmKWRcJXOZItDAL_LF6kJpTo8oNhu5KiPeJ-qyYzVL2GEUBodFuPsvCajYGgO4LFAaTcGM8GphBWHzBjvI84FhBajs3kS2eSepKDi3_3E5qkSKpUOoS5FKGrWO35sVT7JCs76L5no8nphZvK09FBtNjhECY8Vabk_ppP7zTTWz19u4mhNFPuzWfzphj9SyLArNAw3YHIi61rUiU5DpxXTPBfprIIDUEp5MxPZO3j8r_xHCwmVLiQyVRZm9MUrOgdG7X5d9Xhsu77b9WHjqki-1IHU6z71bS8NyrJwjLzLLMu7nWL3c0BX6DcCiLfznwlTq8mhlnxAIeByYE_tNaF0DdDzT5I5Ox7zP_Un8grwmgq8457nmah0m1mzou5j7I8Kf55ygVVL1kwUWTu8OFW9JWSrZeAt8RtY9TpSn3DNC_wBNa-rVtIQ8GYJF7LyBDQGdVrk-3jRMrSoWKHMTnQuwjkHIUPhcZJl9eLjdnenBSPO8QDri2QbTUVpTqFGA5xNNv9h7LvOUuIL2PX04pICoqGqF-ceVfveH2rZm-yvKpGNc0SSlb28Ckh_STTZRF_Y_65cIp4i64RW2f_O9bvF3iSe02kR1nJ0-bZcMi1I4mGVvqZTyN7w-dUNV8OvAj7vzMtM5qCQ-YXJRiQO4gLpwgtPeFO9gRurGp-LMFj_LEXqOCLtyR9NSjncds0k8_naOdZETQUrdI4STxkDW3JUIgZijiO_xL7kfxofd-Kx70VdUDxKlsi1_BVRE3MezQxD09ZfOmC9P4IfpFcxdnY_cIgsv163NcxboGMsDjV9WwM9IBE59S3UH-ZU6OYS4tiGn8c4JCqXum-jYT_CVtea3LdoAGYCgPjm6Q1chHg6lcSNfgafApieYdaofE7zk-IwcPjlXhmt6AGY05R2nWwrXyZYGEQ9ZijE4k4b5i769yZXD25b6cel3TiuZhfZvF050N02oUH67bPyZMbhRSEWOZAR-EWtZQ7yWGqcbEeE30zhoU_kdKzbUJX49HrU-LK82HRKfsHs-vxgZrqGGL6Yxko_Z20HKAbjt8U4tqkW3O9TiZvkL9u8j9rFFsuyl3GPx5celfgLnQgc_lh7CbBIo-rkNqbyL830OFGH9MXGXnS2H3nMyeVUNe5HZxAptvy8lO_IqWv0OXH0W0H_1XtzxXhM-16_xRUlD7MuUkhlW6NtwsD63MRJlqAGP5BqILB9NIevhBLNc1cXwo7PEZCKsVEVU__-bIPC6YdyVJQU93Tpho1Jlu5EwSrlbFBjmHBe4guoGew0eVyH4W1jFFtGqjHbupTklshSTZFIkS4ZzXR73kg_gQFbWN9f647f72HxNqoOnCUCk81NJ55Cx344RUJSDsj-OzWLdIlA3yevHfCw5wsD1nSBhZnSPd0_xbDD1N6m8__c6n8E5P8icKAOyA0SOxdxQTZ8R0csUf1UXwH6nv336GOE6EaxhyEPubFQy5lpvbtmXiq2hmNz_q9eHjxbOAGznIUyxpUvJX4h7Uh5PFEcs8QWN6bP2IB2Ul6GehTA6JQANjecLWONHqt0rM-JGCtzQLXMAmwaLLwU-ZC18MN_qndmY0yTuKRJBBUqg9d_hynDPPFWjpMQL7JW1Yly01HQIe0Ou8xtVCHqHBwFSnnn0GM83D1j0z4oP_kzssYhNWmfoCiYSARYIBj0qZVQlg7mOSa1M-JhbL9okf_ZrEqhnunatD52k5yUsTe5xbhUa8YwMaKCclUZfYCkP19LyZ92eR6atb8rOkm9OoYy5c0envz_UCoEpc-E3hO-4zDew_hvJQj71gKbeVtRmurizuNGiJxWLduYmTKvmJyt6L7kC-i71zcr-eg1a3Y2OH8SQrit2rHYbcY_9CgVwihfp6vtLzQxz0g04jo4xbdU-RH0INH8cQ5t-z6D4opRO1ZqCLrFCc3cR290H_QjeYb49KDxwLaUQel4_-2dlOi9A1VsfNQRUCXJQf6nB0-iVevyhCyMt8H8I_JTLIzta5yT4-wOOj535J-deeTP77qhr8AJFAvrgx4V0U0Vji_lfRmn1cCX_RQHSxbPk6yCd5ugkeiVh8ereFJ7mZhu2E0IA_SHj6inIy6q1VJArEaGRTJmiX8JC-sFCUbswuaokzreTSuFiYuOcxXE6QpopNBDDY1Tl7US_2-foLJb3WVs3pChDdz_Lw9_qEesGDcQZb4-NAPngRPAdUXL0dlaPCGxQU_cNgTlqC2ndklO_zh24_7_S6wkbkSniBgGjeH8MJE9tUEOBCQj4IK5lqBNzn823TH5DJjwORwtZzMiMtiTjuRR3heec8Q9hTHkBSvsKjUXSnmEJ0qviwaqtBojfC5bCwDuW4NGfJR0AzD6DRJA4fdxJC6dB_S4eQmUV34T2kF6XZBTOFg2q9lKwJreW_lD5MBA1uvvTuVN27DZ18dHqUL3rKppGZoDBTo9PKALYE6cVbJ6CkrV4e9USPphmwlubUsG5QL9A8W5fbbw7Whkhong0DeYKdgPpZib8iO2yYN24XUSgTypJJQ71UBV_SLLskRa5xrJbjuvbSUl4K7SPWUw3rufCobX29qVZpaCGZzJKyT14MYrLulLk4veeqr7lUBKQWGh9Z_F1v0U2nBFGiFXWflSXYCbwIYYMizO5t1uhygsq1g4PSa1-htFiTvPNUV3lg4DM4lQF3Ka7qZ5iEL5-7uJbNh9Hh6B9P84_asP9fsZ8XXdaEgN76zvfDo2BQ72a0U8bCq8YhjYKY6v4s4tNbqfjpdx0JCG0LifwonnXnIsLCMZa4YHwpJbGmCp3450uBRHMROqMeEsbt0qeiETGUNibLx_0U5auQ-1u7LYz86pj7ZIpyUHHlK0lfnkqFswuqFmHRAENp7U8DzlKifwb9tihNQz1M3NYfAqmpB5KFte3S18vZdLYwhrz_KQvo6cseW1hWlzbU4Mtn-suQf1N56edsqgod3nORJQWQpGHuKdQWwwpGUc6AoxVeZsq4Eax_irz6P1LG3YURJ5qBcDId_2tCJYxw5j_gtUqXn_lp4OnL3YV9h3wDxUxzh-EOAqaOIWc0Ufj_-8LaisQES4-o4U1U07tOvBckVHyhho8aTShFrOkcMatd3zxlblPMw0wj0OPWq9eUKMkggaKXsHNtz1YtxTWfB2v3jg8LyUhfVZOw_WLhREARNeCfZCDRXyb8b63rNAkYq51v6JxZ6qaGVFEHxX5cgMkAg4UHH6q2rp9FFdbAZ8qcIdh0xguHzm1JLRB3j3Fr_AXkGndawrbF3vvF-B9ClzXT_wo6x51-H_do-shIhZMOPrT39MwRQqZ9zmWAdPDAkEL-p9EPBVWbZzgmbD_-r_c9kkIWPljvFKUSMTHmKg6h2YZVO_SDdIPKmOCu7uk8sKPjiVPE8_9FJsjqNzA28e-U_vOm1xtOnh2E4h6qCPLo9Tjys2cTkhffWpbwleIpQDrL-OYvqyxikm8bD5I76AHmZE_HznwsVYbGezvKrc-WSc2-xXc4CCeRTKwS92HNk-Z-yiI8N5kd5jhE4wIHaBNzNNu9YjmXjd3TR_APTd9Vabpg7t8qDZXcvoyGv0Kdh33EOYM9uSKFWInUKOtjlW1bTTOmtEtO6VuodhzWLfY4MEMCmjwbQeMBQr-_ecCnA_1iEObcMufyU3hEnSL-ZsREkLotxOBwnnNM-Ht5ITJdmzVAw1mFAj2OOjs8e-wi87PD8zZiCGddEHyGC2wfKILdKs0-iaNKqa5o0a6IbO7YgGVG1t8U5ZDyvtckpMD9DRsQGw8KyXHTRgUKwqwDgUQWrgrsWeYuGPWzaqTAYzly5MPBtqH2QQJ_OiBcRntTA-QiQwpUTJFxK6HkQAEBG-0J8Ywba9bUYGvNYJ4d3npDA8HUY1Z7acClatBkheDvSXLfa7OW-Y9iBXM41mb8ibWOQtWVvdsr4824Ap-6eE2pXbx4-Tg0zTJy479E6pn7TjTbZMcTofP88RYorsWkH8NUq2eEUeHM-XbqAcr6SK4EiMDAofd-slcQe71jIl5qWeG3UpQoywaibc15XurX-rZbCXgXJ8or7YhjJLsqNONUH5-HEIc4QP3Br2CHZ-3Nd3Vi0O_IEQEsFKukcrGmNQ4bRGTM8Ez2D4PRNP80yfX7t8HZPV6kD1TGPmI6RoFhowh3FzP5Nt1U4bLr9vKfc1Z1pJ69i88ifTbMBGoHyaMMcdgNxmShuDkfc6fB1sr36Sq9TTSZwwp1EIt6n6GFIjXq5EJh0DWvPeUxBM6AEGOvMhOUKXydDsYuSQGCtOfLXU9hQIYhpMcXaPxo9luItxfPRn7uvtZodduWeC0WjKKSoGztOyUxaYSomTPAZmc5IOCycdnM8kH16P2U6AUpBW1DMd2wF4v-k99PP24LCKP7TJmqneIA0qBQedEUAM5n0KjxgsMmIHK3vDbJNZu5Dk6Pd4l7SsyeeB7cgXRLfE1xu-PwEsjyj8Ja0z1DVUvVo1UYZ5kwBHeykk06hirQ2ena4-ilHgZNSjhS7PkutB52dw9bOp21z1lKMebZus_7ZMeiiHPTINNQFu9XQzB9bqeq6ux5wc056bgj--YYEI6nS6cV_rl4d-wgKh1vqi8b5ooXR7Cr0J2sclN2wFpTj_BiEccD_F5a8kZcLh5PU8-yq3EySayeKr_ppRSdtibr4dKHVXiEt4TL79V6aT2y70VKASb2BEjl5KH8H7iDT0FCj4NCtQxtIxXeyFjKPnk4Jtn8TOt6iqSawByoy6pLuB-xsjOg3SV3VWYyJMk2EqSCRIySKgHKGfWcxW5W8VamEm0j2fxAvSu1CFYbToEQ_InAHzR8pB_M-t-ilyC3gADMd5IuyUM5_hg9J13EU-MFdLkLMFDkYI90S3_i46xCIkSoqBqJA0NKD2wG758jNn89DnH0F5ZAs07WTLEDVwwIMAg9MNFFD1PpECoUqrJcT7FZC6xaLMtdd2Z0aa0t2MacxcFgASGswvoKdW3o9BD7ohCEbQKyp2hbS0AU5f2lbQfWyn9kh453d8wDiTXmcQ85dXd7BGwOFgCxT0MXNwkbDDDUvEg3cmygdbXgeHeh9LTscPVi8jyuWWzZwSypa5ziGM_eviboZdthNV3fTPFq7g5A7XrHKAmv5DEm9N24881gJIzwyZVgouY8TOUsgmRfqnfYLBwWhKNaq_W7eDrMhcuAblYe4ROdaYOEduyDHKZUpgPFtBZYUc151PvzCKra0aHBPrYDYE5q0qOMNpxQLTKlfTpBoOz57UaCAkVLF01zTSdOk3wI1--KlL4qscxp-T4cqGgoDBOJhF9mJXwytsqdi558ZCBn0t7aqFf9oqpnES5-7GxRM7Ka-JjO2FD3jyE4Gd_m_qx7_Yg1MY7_rF7l4w_vsk3S1HWR9GBQG5tzZ8Fcjs9qVmDrcZsNgatcYYx4iCvrWomG9omTK91vInw8q02Wb7607uW0ZF3fA842rjtXWU4MrgnleIpu6Qn_F4wndJPBDOSv6EtzfHFTaRNxi6GudJCDIKI3_LglZR2Cdq2qEFLhbfYE6BKObBhUSq5PFn_cOgx80eRXmxvGDxPPgbRhBv_JfyWXM1SiE9BuFIQSHcvk_Bq69m8Omo20YZfHUZg6Y6v8-4sjKCrzrZJiE07V8NE6cvEchogg5kHoLgTtirPZfYW-0crQR2_vO8s50qXfgK1M73FDjkBVixyVhO-vAleSC9kpZv79csY-Tz72p55H_dHZv0tu_l2h7xZXAEMxyBuSA3U-psADA1mpA_7LM3Dv9frKueA3Nr1OGsSdXzy0Np1SmcmiFCicc8wHrEhZ91ahP_E3SZe8HDzXuZGZzbJxbfrxGkp-OIx_gNd8Su6tDENvxL1mV-oxPiP_jTQjM77W3xIyM8nqATvSnAkNDcEgQ33dcmfOSEjuHdypEls77xUdDJYomNigNMH44EaskxVzo6oE6UoWDesI4-LvPulFVpLTlbQS99YZMAyp4XGpX17dxlTrg8RtPrkgziEaZWtxi-5pN3L3-10IDL9f5ePYGk69oUxr6vUEdWDYikZw_FumU5yRYgHUKm1H5ePt9_jLHISe8zpelUpCsAqWNbywtIytrMDiIR4dPK9vNnkzeXXUmstWyzhlnJKAkESs4oTmArXxLPs_XBj8lSEFKmUEFFmUGaR7HPXVE75Mvfe8x4iNIRPrgku7f9omNGL4Z6e9vu0Lb0RrjpIKb4dwI_EKSwP-D8gdJdutW80Gnht1VpGgSWcmhG1t_7j8srz6K2tthiN4xfC6F7w5o1Z2Ee2T665gvYOatKbYd1uo8EFuFBsICnSxsypIqBK0KyjAheGvWOkhPQAgBjcsnHQQFAvphjs0GKNI6tZbbKPGup8lNZBFpvWp2LscFCsIL-8U4vQ4U6Q1UMoGimK7YMgg37KX8M8LlzxQ4s_lv026N-ETwCWDqQ-o59Vsd_nqE9YEgzNKDaZNgmaaRJ9WC9A0g_JYT0-PmL3t-Y-eggKWSkyWfVncXT3m3OP8_3MT21LGWkAxJdE_CB8HFky0vYSagwjIsj1kfZvoikLHcAikFxJKzS8VuobRusQaMUonC-qPncJpAGHJmitUvRplJ_3BA-gKceKmZjNgEurPWHTfTFZxykh6sv92RUvVjmsBplMbx07BWObHU2cuqroN8atsYM9nX8E5v7_gOb5W2sNu1Dk2cey0yY1FwFc98MnZQCMUI_CO555Zhj86Yi3XaOm3QRbatRohC3ayKpIxzeiDU07Hj5tEMEPHqApI5Z7K9OQFGo3gorRy_ga_JPNbes0TETEF57uDkoknCH3OfeX9d5_q2S-1_DldqbxYV0U8BDsRNOm67TBL3qy4D4F0FiKFWcTCt6fRDUvZnSDkAX64PFJ84dkV5IhmWo_iKgl9nFT-erEVzXLqbFmdIpdPdluPpFUqBpdu2ncqqbL89kaDMfuvL9zJHS_ePJRstt8LvxVMUV2W1MIfVL2XokliWtb_0gXSXzOdUBe7uxN8Fy5YcsR_D-0uvRvy47Vj9XZRQmf9ST7ilGHUhzdg6GtGSO10E8rhvr4HC-fA6vzRaNCOH6MEMXNj4G91jqJMnkfysqdJk7i7za7KNR7RRjubIKYTKteFL6cdwEOqm3oDSHfwd5ByuxD0A3uOxyYNuunGOxt06jxTpqHJXOzDvbfDycGcAxNo0NvdTEXgr1D3vR-w3gfHQB95pUWbZbydJb63v4dxkwC_3m9aMgFCoFAWhq2iicJmaEsSN2K48FNZtTBNDyqS6-46vJu4iAha16wzRKyTis1AiLhqo1rt_GgGqOnmKmETP6K8W0BRkYFtWzG_h1BlFkssMQyUthZger2EoKDvtgO9TlRDH5Lt9T0RTOne33Z7WH7O4_MW9gfkR4tkcOzHpSjFHT7jITerE8feyDfoxGkWnYJSv87ATGIyDHRt2w9V5yV4B8Yc0OWsLFoymxGYHTioKQSPQ_itvsm4AeshUdKmcVZs1s5nAP1Ggs8PIyj-FVW0pdezlEIG92MvPmn1niXLaXV-H5IY-FV5Y444pM-HjUb1zcC2ldHiMuWjAEZiIxjG45hEw4Hpp-qAg2z4p0UpY1DWOboOhVFbuFdyyG-gafdUkkwMM2agUaPXzRZb3IsUXyPQcKD3fgl5QnJGl49bXHf1qtZfedi0GHm5C0qM55YRecLHs-ArGk4Biw6Sj-JrfD0ey-38p1-DtNRzFlvHHcmCmYw_W6SdZu0I4SeEHaqnvptqBsPiQeUoUeVTnJ4OXWy2hoXED72bQV2u9geGjsntKCTPlaRuwKVM7Y6Igh5VfwKp244cGhB75l6TKauvoQLoi9Bj-_DvBwGujT8Nayh1pnMzPqQ9qMGB6hd5jWq-C43uCnKFESRH7pGRgKhe-E-qsujWEmEKu7Iyy6i4t1qnbnNl1UvxJilV_YOPCZxGWVcjxoBaJ5AbmVSrGPG3uPXJaKmlwPhZug26gUMiFu-1DJ6nMMVyrqbhm7cWJ28J5bQNpxurDsKQWiEnM3tEBExwgsPuIeMtmojDRHIAppTK6ST9jzGJVGlnTsByRb0ydLSNWWsckIq9xs3uLK1KF0y7IgSre08fYidQR7XpNnwZL8Tg8dpyhx4-iOh9JwgYAZuzsDATFlGD6ZYJge1BIvI96GO0XRJIUatabCfZnnhabrjBsSxdOUKixg2ItIMoBt132wUsMzCqUXUZ0TYNmzf4Inr66Gxhobf_IoP-dF0eVbJur11mRMXACRJEeVpxypn9t1NIlobp1cp_vbjQo7Q_JYKp6TwI-30iN53U-zL6-A1Ha2JcylclFPtzvMvM-YyKyT3WR0DTup5ThZ8mgyKgHILOxQ3ati-hvt6AIX47gM9PHE51HA79rL1Ept9ev9cQpdNA9AcQM9rEEVPE2i6VQrZe3GyT6jzWzsoaLTpX9aaUBikYy3899_oawHHci16KcqX0Y-vE4AphJAs3-unri0lMSzx2qFnHC5sgKIumx32XiEnkRHIwBl0OAnuRIerljclRaP3QHOWlE-t4J6K7KqWk7aX8169RqHbUX6adiT4z2UIAC2uAtJ_cj6ifNm0mS4tNFRu5dgICDnJkfX1zN-f4FaCDOaZrtShTc4Q8zgnirSlU0kV61UmVntYD4fOBr9aejv564YQhV4WSWM8NxRb5NTRgFXZlMpmxeZ9qDB4GqcuameoNbPhqYS_LgX0HO_LIxkjjB6uTrPh1MhloWdaJJSxakhJp8MzuKW9PaRrxnY8-BLKn10qKf_oJAK34j3LT2ELft7wqGJ8EQsJwFYMZmo1Ls3xXsOUV1uUgnKEhfKOs-aMvCOSdPTXeBfw0JsMLoRi33a5OnHGYBi6i6bTxQse4sL0HX6gMOU-UX3ifxTHBdfND507Xj3rWvGatVcjp2LfG9E1Dp5BmcSFerPU36CKtsnh7L66VQttO0YUtDFj-iEFEZotLTmHkbug9natnD6qkWfGx0ORPcuDYf0CtbSZOgf_IE_XtQwtB4-Jk1dAT30tQbhnX8mRFOUfazx4DTQvvV5ZFvblIENbMxjfMxRzh9okmxTRegFErDZKM1rqMSrI4rsFYLv5pGOipkUlfY-uOU4QEWFwu8Ti70yUFi6GZoD0XtOluK7jvHI_g5maqGHRJcpTV8srVLRcY92vsnlJRCtTMSL-bd3_rUvBn2WeVrlGpQSeoq6VVvzn1ATw2uNtkqy-7_Grlxj4xgHpdIBbGsvM5rqk6G0K45c7xmhdmvn5th8wO3hOdptCyxPirHTpC4t0u7PDEKnjR-77GImxa9qfaiUH8hRiwFUQ84vP8ShKU72xghzU3tGg0oddCbMKZN1l2bTAELBy7Zh-nEMvB3raU4gXsNoCbGegiIADx-mm6XCwr6ChSeoEJzY9RZ50jMBYRDG8HSOBVJRDAkjC8W_c62PT-66CXpszUiEYiHa09m2PRCuPnfHgzwI5wq0dB0gO4d09As_tSUwtPsr5kFuBRBEuv4iuFbDq0dT1uPX6hvjq-BxepXJksTue-QrRHP2RXjS30xNRb7YMMdZmwnBt0l39D9oNUJ1fMsgc9xegvIBb42uNM3U9N7dr41R6oaXsjifVkt3HwhOFgTbG5-LcBse_YEf_OPLp0l_aO-NnOrskbgsfsIlXKcFICelQb41iOo6YZyHPhSBLg9frc0XbX11b0bIl066Fn90VpOahyLEeqRjfsdd78uuvVHPDN_s88XSbnsMsRNcGn5Xu3fIPlc5PrXD3_F_CEshSVxAwQQ34k3bmEol3pLk2R3B15m4zWH0f4yt1iD0vk4JJ1cfrrpi6BhF2pDu5q-YsSPZilCrhLzf_90mG6j9MGxFTg8weIrQ0GezskyL7hDWuJUWJ3pePU9UpmMUy9Q6F-NVZxj8_cFyyS-xtrqEXPOXgNjcrtK-RnM_qK5k-4omoT03MQ_LZnInoKToWE5MMhBK-x6xDxKfiHMbaYmD60J_c0bYvXQCjDRBD5s6IctUD79KdiVs-Ivp6xzjPUD3h81egpjD20sLFFog_62uzcy3EG4VbDfwP0uftb7GTtZCecBK5o1a1wmWe_5WNWjZa84E0PAO8XKzBBZ2nBzm3psN-hnYsfQRCnRxBkjkMsIgYmNd_CzGFQ_q9i-XaRWcl7vJ_oJ6v8AJRCAmfJ7uoqCXs39VWLp9jLxi2qHvFZEYUz7kdS9sXvghyvtVaqzLq2LSknVJicMqGmFyJvf46zUJxwV5qaBWvNilruLpnUFN3jF13b0dS78TBRyDnkhx8F3XQx0gLHQrK4gS2EpOEzDKxtN4bbIFD5_rNgagGel9FM8OanJAwN_LKBeXgFxiMAecUoE7nxDf9cvqJMHHT63Lkz29S8Vm7-JtpYPnQG7PwPKZ2JM6YvyJbdmwK7vcIHbTQtyND-dByOIEkqSIIMb-9mvYVATXzWoraTMP1_tg7TzZpk9qvdJSb2cTDDQmNFreqWLLQQHaCu_DvKoC6nYGqQ4Br8eiBOtXrp3YSXhs4zum0oUEUNQtcyUffiXEnHwNUtG3B4IYLzfTVxrcQRgxCRUDeCjFPE87tQkN7z2cYLJF2g4qwf_TkkWar2GGC0wvkKtzm1yl5o6gMEx4cjdPJWqSWcKc8rwuLSasUsk5DU0BDv_pRta3rS6lRJvLb_WyD6SdmT6eElBQEu3QVNaTE5WglaFPBIPnRMFGw7olu_mTJ8JC14C4Pu_F-GS5fHTViDVtBfSr3vxL5b4gjhH_f-02HMeLDOphxMez9PNrVga5j0meTWIMWM-I1Zy_w3o8-6FDA6hFwJ8SfOTZKOHpExqnLW4_2zK9ZlvYzm9PEzbXS61skjH3QObNtpsEDW_1oZN9rn_l410h6g9PC7wb-mfZCJCt1t-JGl-ewHI2JZMiuGiTgD0MMzegF7MzKJXpoYAQQlqT6cHlb-2xXHYEyD4EmntwJ-ZR2IZO7C0vXSkfo6KZVSqwLFTZ6vp6F-6qJyyFjQWgN6Mz0Zb4iuppzgTrMd2R-75afkuNjbo3yskWtIUt93t9fqxOMpD5l0W89dRazZVILV4g35lKDpcF-fe8ychgWqQHp8EG3BYOHcuvtBQMQkbOicprZgJAed_8KAO4zJL5-8KPT4diSZF7ECjRfdSMsMFaJIHfJ6TYJQnBjILF35PrbIMOMCqk9ndMiidsXbCUCiMJ05urBYIM9xBdA39HEk4p83Ds0mzbHoH1-_xabQM7E9xzrvVTHAeWICpuMDVhPo_SdQI5Z-f___RCGvEjNcFgvraHLEScZoLk9oq8cqSEz2tlHUxvyIuAfia66L2YDzJJGo5CNXtsXp9Cft61ImRgoEtN9nHC5pKZKqahpE9w2ZIjliS1sHiWj7sxH-0LMb4j-BIt89gYfzyD9GxfVGbQgcYoGT0uYLf0f9xhsm2COsBo4uJUFqL7URvrpB9Q83gAQjeJvW3bOlLRz0SQCN_jijEXOjeJvDrymJ8tJC5y4lKMov924UCzw3El9bL4MlAxGvyc8yLv2z_aRzL8I4BQcZk4x8WFg7_6ClrI6cf1t4g0A3pQnZF7srT0JwRE8sv4oU_gUZrnXawfmFhHuzWo1K3U7U49IP5r2QfdXY98qaYuh4v2K0r0u9NTh0sI-Hzh6_QbjoiPVt6UHT_SRwBOPC500fImzIGY35m2AxRgraSx2XeTAuHAlr9J9OhTJ1NhY-XjOc0muh-Y86z7JNd3E_G08SQs5N7RtTrZjxELz8ZYC8DPKRHSyDA-CLSHY4rdsfjEIYCIleJ0uRORplG_Jt3VLP3R_if4LBy5frI7NwN4Vk0yotRdtISgroHql4hSQUH_nwwWaPQV_xvMBjfkuugxhfUs5pXOWbpj8A3C84I4xjSGMoUPqKA_enj6MJag-4PPSosL3JpzfIy54_Hn8bOw99WHTfJG-CiUySJFy1M08YHESEGZpKqZmM-f-M71F3KKvybpVS7tgDu31_GzIQWknU5P2qZrECS-ZkWN9-Mgyew58Uuh9jKBHAIHNz45wklpWdY1Md7RD436Y41ieQv0cCfOARltk7HgzrqzU01nYkXuuhRaNK8YPQychST8GCntcpwlNBKhArhc4UMTR-vx8FwHpTBwjXSRlOaxbvhJuEksf9U2DjBWdg_zNRruCkQwoUBvfFR00KGocv84ktPrkQCa98zdUI-CrCu-Q4n6Md89UUQVIvUiVYmcjDu4UCs63XTSYskb3ORVO4oH_MFEpSPy5R5YLdtHL3ZTdsoTjWoZNJRuSEyOrCmEvqU503M3fRiZBAl3Aj88H5p-78peROOAtoLL2nlBLBkFYa93ZFSn2RmHTCa9bdVJ2kY0aqq36VKogQPfqIKbbvoH8t6J5g7h-3vccbKPSeWMDYtvoJCzQcmXh8M3Swkj4LG6QS7LyevhjR--Q4iJPp2Hgbqik_QK4LprZYCfegwncuBMG-ntZ6wiGnDrZbA5Ywh3Qr8b4e4a9sLYb_XCjs1m0j5dyLJDb2HgaJP3WrWJmB2W63Hf8VdOFTF9iymtXnfMu98IYLQjHbdrR7mbTax5l-Pf9hVsR2CljKiZHb-DJ-48anVbp392YIJ1ekZlTWtkcvmwk-ny8E8LkTfyfwos-6c6wCuuwnEMPryhiFfcpH7Peh9KzExVmjLfTFXP_A7YbSNgmk2_66aa4Kh6ouiVry_pdQ1mxzqJr8l2isRivZ4lwBLrGx8SxGtUiLwaof-DZKCI3gPTjFD7_yraMAn1k5NXLYM1F-h6YEO6ECaizJJdY-bM5HeNV8Ngh1m25vSYdS2U0VtHaDfIgYBwlM3fJJHjHmu_9wj6F399kKNgFMOWvdra5XtuazzhJFayAuJ4fqllDczmzaSfPVJzI53QFxoCVAJAF8weGsJ_GPBIaIowuGZh9QxVOwCo9HCl7t9HkX1c3j0-hzCRI4SBNktvVl3uGczTvtaBGltbQB4eaGnPEk6AiwwopzPzATfVoE00TNhpWw8mPSPOzIcdQLiI7XAi4B7Pwv5NITXyqlTHM5vbpTryd4L6V7C712kQCjTBXCupefDwhsJoZIZYzzwmqmraPXO5OfBcX6TqQUbl-a_dMcc_vNNzgNpgCGvk_zmihuJSLfuLM29NUh_oeFyDEwDcwcMkK6Bt29Ef7YcQc41yg4ptIztylfdSZyhL7FGWjhhppEY4WbJjVOddGPkm4bZKxC81QnqKAG5SitujthGiCxgKS9vJ-hvXBSJSjYfKy6XsEnZFR5R8ARxkTGOilCr2QTYnz3gJ8C2CtAZzuCSK0qSnGS6cmRObSNDQftlcqMupYARzqNBrLKmfVrMlD4Ec2YzUZThrlWbewm2HHxe8RflDwYyTlO_KuoHin85c1_56PCUFp9xgM3rVS169ZyM8nF6OWMO-p_hICE1BDzqhKQGnqse-SpdxIMC66HlSXDlT6vUNFHycHIdm0sywRIx1luHn0iX3f_Eqs0QidrdTf-MXCMLljGC9kiXSDb1JUp6L4P6511nXYIXLl8Agce8wHKxAuYYJYjiH3ltUtYjaqlIWnyxk3ZzfNuShQgYifQq3agcquomqomUX653C4xTIKfHDjbcb411mXsb4Gl6KrcE1X7Phf5JfWJxima3_IFUTl89desMeYBKx2N1qj3IABAWHPv-oftqV2X3nxBN8ZaV4C28vbENpxvVZtnvYbCHpAb_ZahWouUYHZ8YNFEGXqh-JtfC6GYcshniv3subsOgumbTLQ136m2yYzzANL-MaE2lBjXcflERGvoTN1v0UebovLt0m2Z0p1URuSLxdURMA1JWTP2vctEb_osuVhmqT6SPyj8swpg-xM8fmj21wvKJCXCfTk5MK0scR4i3Wy6YmBfhRm2bsn-DD9gcs1zwGTKUzaYOwgCfoAakaQovimHb42JgXOAYOPndiDNtCsJv1f8dPoHP6k7Pn6suqGZpP2MDw3L_aMEQCSa6BkHggvWffLXKwA86gvAKTtYuyJz-ia4eGsMpESIeKzQeXi_gZka9q1-otVL_QJINPG-cPtn7tBrMmNsL3aA5oPeJQywfrxK9MpHfos8zoBMyaF15VvtT37JAEv3MIq3WRczIL8IcNhbx2Yh3j9epL9mS2ac52LklXE2pVo_mqImj42_-Avu00oHboXjd6ZaiE9l8Ulqye0gpatFsLZl9CZNNLH_BUMAnCU_-M0q1-YBxm0P4VLYP5DAMvCZR1qbjQPbnRJ-jbBocx-H5wdO6I5AMQJFJzKR1JY_-LSih5bHhrgqGoKjfUPjLLvBsNodscY2hix8ki6tRdJawKf0MVuE4JB8gKyFLo9a3hIdrqAjLoBpT2EntbQmJWlkg1Djx0TTNUQkkSgQ042kzjHnrUMJcJcFQmvKDW5qCqU21XhDpW_CoKOY0prLxYzgYTGs2Sjq0RydyO_v44dsMcWsZLpypxd9LFnwniUgRYZPBd4BIOibgrJEVj6i5tv00TwHHwmhMhhfQ0mJkNW_StYkVOBEyjdg4uVvYiA4RMiDgz6gm875OkpVdmqzmAryOEhH5RuUemvGn6dWTsuZVaR9gAhx8Zy0o8XCD3QU9QlJF3YwnqDRyq1uBpnutyN93kT_9S0sibjWkYi-UNXMkqCycoh2uocnzk-sBqiZZHB3YnMVJAkrj9CFfqIi6lg73_73D_-ydYeTI_5ieag4PXV1gHitimL9-QOyKePtbrzot6k-Z8mv3pqDGD8wpG3-4INumK7hYqWgVHgGNkbotY19GpSnMBBwxWhAhmMbSrHFA7Mm8nYEJ-RdR8DN3oEMwLk_eb7OUaItHI5rN6pG7k91Tsgo-oANynSd8I-O1SVEjg3EkqQ4C3kLW4W_Mo3QfdLj2N9016o2YoiVkp1PkDNcT1Tjsi4L7rMrsIaL1PTxguUyaU6bz9XEH84AVRbc3aATfp4Ctxkjbvk6-ZKvw1CLVFM9DtW-inbEcLr9n2bH4QM2u1jVaAlqfduZDEGHecIifY5eOGVTYgpYbA73SM9PqL7vsNucqM2w_xDoh3jQ_GIDONJf2isbCvsD_R5j678UMJOC7Fu_WyhisVhNxvr8WR9P-fL8uSJ_54MCq3OKMeynyITE-FeS1lKy9fMyAN5IoZt4cQcxv36Nq2tKuIs2b0fRvx68IBIED6OdiThW9MQ67qhcDsUREZkdxJIbxIEyONSFDF9OpyNJGCzu0A6yYTWz1I98tFPzv-VAKcZf4eTjjYGRLUsxxx4UYwcGaXIdN35YzllSi-MV0EufXEvNzyKn_plR7ADPA30ru_55lSMa5WmzTVzg1yQllE5JrRr1mAzaIyZumwWTFhcClTR8oFykRxOUHWfxfleybZAaBzIMTcOtrvj72nrw_doT6W7cqKQbbUy1a_1YenNYqhOfVcO5w-VQ1JJTc2ZFXCkogDi52HrDCVK9LZvscOJieWl8f8wu-pqW7doe8r6lhUJq1PYxBLX4TgtJiPwv7f5OvD_puS1FlJyldMONeffMpdWymfWSTTbc336m2QZ0cH1vxK85ntYK7bhPh9JydmIKHTkSKorvwcRlTuPKyR6NYrPg6sEchE6-SG_dh4YU4rRJKawXO2SdMbQY9WPA4OyRf5sWrAHrCk4r4XZ4k7C8f4nI83rqcTqV2UDbRAFONN3IHwi_5PcSLFuOxJi4w_mDBGIggIJHZUW1zFh8smBiMAHL6Rh86chJqW8-sxNBdcyI1ZuTFIWQh1UpYA8";
		byte[] thumbprint = hexStringToByteArray(certThumbprint);
		byte[] sessionkey = StringUtil.base64UrlDecode(encryptedSessionkey);
		byte[] keySplitter = StringUtil.toUtf8ByteArray(KEY_SPLITTER);
		byte[] data = StringUtil.base64UrlDecode(encryptedData);

		String encodedData = StringUtil.base64UrlEncode(concatByteArrays(thumbprint, sessionkey, keySplitter, data));

		System.out.println("encodeddata==" + encodedData);
	}

	public static String getEncodedHash(byte[] bytes) throws NoSuchAlgorithmException, NoSuchProviderException {
		Security.addProvider(new BouncyCastleProvider());
		String algorithm = "SHA-256";
		String SECURITY_PROVIDER = "BC";

		MessageDigest digest = MessageDigest.getInstance(algorithm, SECURITY_PROVIDER);
		digest.update(bytes);
		byte[] hash = digest.digest();
		return Base64.getUrlEncoder().encodeToString(hash);
	}

	// Function to return the XOR
	// of the given strings
	public static byte[] getXOR(String a, String b) {
		byte[] aBytes = a.getBytes();
		byte[] bBytes = b.getBytes();
		// Lengths of the given strings
		int aLen = aBytes.length;
		int bLen = bBytes.length;

		// Make both the strings of equal lengths
		// by inserting 0s in the beginning
		if (aLen > bLen) {
			bBytes = prependZeros(bBytes, aLen - bLen);
		} else if (bLen > aLen) {
			aBytes = prependZeros(aBytes, bLen - aLen);
		}

		// Updated length
		int len = Math.max(aLen, bLen);
		byte[] xorBytes = new byte[len];

		// To store the resultant XOR
		for (int i = 0; i < len; i++) {
			xorBytes[i] = (byte)(aBytes[i] ^ bBytes[i]);
		}
		return xorBytes;
	}
	
	// Function to insert n 0s in the
	// beginning of the given string
<<<<<<< Updated upstream
	public static byte[] prependZeros(byte[] str, int n) {
=======
	private static byte[] prependZeros(byte[] str, int n) {
>>>>>>> Stashed changes
		byte[] newBytes = new byte[str.length + n];
		int i = 0;
		for (; i < n; i++) {
			newBytes[i] = 0;
		}
			
		for(int j = 0;i < newBytes.length; i++, j++) {
			newBytes[i] = str[j];
		}
			
		return newBytes;
	}
	
<<<<<<< Updated upstream
	public static byte[] getLastBytes(byte[] xorBytes, int lastBytesNum) {
=======
	private static byte[] getLastBytes(byte[] xorBytes, int lastBytesNum) {
>>>>>>> Stashed changes
		assert(xorBytes.length >= lastBytesNum);
		return Arrays.copyOfRange(xorBytes, xorBytes.length - lastBytesNum, xorBytes.length);
	}

	public static byte[] decodeHex(String hexData) throws DecoderException{
        return Hex.decodeHex(hexData);
    }
	
<<<<<<< Updated upstream
	public static byte[] hexStringToByteArray(String thumbprint) {
=======
	private static byte[] hexStringToByteArray(String thumbprint) {
>>>>>>> Stashed changes
		int len = thumbprint.length();
		byte[] data = new byte[len / 2];
		for (int i = 0; i < len; i += 2) {
			data[i / 2] = (byte) ((Character.digit(thumbprint.charAt(i), 16) << 4)
					+ Character.digit(thumbprint.charAt(i + 1), 16));
		}
		return data;
	}

<<<<<<< Updated upstream
	public static byte[] concatByteArrays(byte[] thumbprint, byte[] sessionkey, byte[] keySplitter, byte[] data) {
=======
	private static byte[] concatByteArrays(byte[] thumbprint, byte[] sessionkey, byte[] keySplitter, byte[] data) {
>>>>>>> Stashed changes
		ByteBuffer result = ByteBuffer.allocate(thumbprint.length + sessionkey.length + keySplitter.length + data.length);
		result.put(thumbprint);
		result.put(sessionkey);
		result.put(keySplitter);
		result.put(data);
		return result.array();
	}
}
